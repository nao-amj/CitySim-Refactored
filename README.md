# CitySim - リファクタリング版

本リポジトリは、オリジナルの[CitySim](https://github.com/nao-amj/CitySim)をモジュール化、コード分割し、より保守性が高く拡張しやすい形に再設計したバージョンです。

## 主な改善点

- **モジュラー設計**: 機能ごとにクラスとモジュールに分割
- **クリーンアーキテクチャ**: MVC（Model-View-Controller）パターンの採用
- **拡張性の向上**: 新機能追加がより簡単に
- **データ管理の統一**: 一貫したデータフロー
- **設定とロジックの分離**: ゲームのルールとUI処理の明確な分離

## 新機能

### 地区システム (Districts)
- **複数の地区タイプ**: 住宅地区、商業地区、工業地区、教育地区、環境保全地区
- **地区レベル**: 各地区は最大5レベルまでアップグレード可能
- **地区専門化**: 地区ごとに特殊な専門化を設定可能
- **建物配置**: 各地区内に適切な建物を配置
- **地区イベント**: 地区に関連するランダムイベント

### 統計と可視化
- **時系列データ**: 主要指標（人口、資金、幸福度など）の時系列記録
- **グラフ表示**: Chart.jsを使用した統計情報の視覚化
- **データエクスポート**: 統計データのJSON形式でのエクスポート機能

### 都市マップ
- **グリッドベースマップ**: 10x10のグリッドで都市の空間的配置を表現
- **視覚的表現**: 地区タイプごとに異なる色とアイコンで表示
- **マップ操作**: マップ上での地区作成と管理

## ディレクトリ構造

```
/
├── index.html          # メインHTMLファイル
├── assets/             # 画像、フォントなどの静的アセット
├── styles/             # CSSファイル
├── js/                 # JavaScriptファイル
│   ├── main.js         # アプリケーションのエントリーポイント
│   ├── config/         # ゲーム設定とデータ定義
│   │   ├── GameConfig.js    # 基本ゲーム設定
│   │   └── DistrictsConfig.js # 地区システム設定
│   ├── models/         # データモデル
│   │   ├── City.js     # 都市モデル
│   │   ├── Building.js # 建物モデル
│   │   └── District.js # 地区モデル
│   ├── views/          # UI表示関連
│   ├── controllers/    # ビジネスロジック
│   │   ├── GameController.js # ゲームのメインコントローラー
│   │   └── UIController.js   # UI操作コントローラー
│   ├── services/       # ユーティリティとサービス
│   │   ├── TimeManager.js  # 時間管理
│   │   ├── SaveManager.js  # セーブ管理
│   │   └── EventEmitter.js # イベント発行/購読
│   └── events/         # イベントシステム
│       └── EventSystem.js # ゲーム内イベント管理
└── tests/              # テストファイル（将来的に）
```

## プレイ方法

[https://nao-amj.github.io/CitySim-Refactored](https://nao-amj.github.io/CitySim-Refactored) にアクセスしてプレイできます。

### 基本操作
1. **建設タブ**: 住宅、工場、道路などの基本建物を建設
2. **経済タブ**: 税率設定、経済管理機能
3. **政策タブ**: 次の年へ進む、各種政策設定
4. **地区タブ**: 地区の作成、管理、専門化設定
5. **統計タブ**: 都市の統計データの確認とエクスポート

### 地区管理
1. 地区を作成する: 地区タブから「新しい地区を作成」を選択
2. 地区タイプを選択: 住宅、商業、工業、教育、環境保全から選択
3. 地区内に建物を建設: 地区詳細画面から「建物を建設」を選択
4. 地区をアップグレード: 資金を使って地区のレベルを上げる
5. 専門化の設定: 地区タイプに応じた専門化を選択して効果を得る

## 機能拡張のしやすさ

本リファクタリング版では、以下のような機能拡張が容易になっています：

1. 新しい建物タイプの追加
2. 新しいイベントの実装
3. 新しい地区タイプや専門化の追加
4. より詳細な都市マップ表現
5. さらなる統計分析機能

## 将来的な拡張予定

- 災害シミュレーション機能
- 都市間の貿易システム
- より詳細な経済システム
- 住民の詳細な属性管理
- AIアドバイザー機能

## ライセンス

MIT License
